@using TranslateWebApp.Interfaces
@inject IDataContext data

<div class="btn-group w-100">
    <button class="btn btn-sm btn-secondary disabled twa-first-button">Project</button>
    @foreach (var e in data.UserProjects)
    {
        <button class="btn btn-sm @CssBtnProject(e.ProjectId)" title="@e.ProjectName" @onclick="@(() => SetProjectId(e.ProjectId))">@e.ShortName</button>
    }
</div>

<div class="btn-group w-100 mt-2">
    <button class="btn btn-sm btn-secondary disabled twa-first-button">Target</button>
    @foreach (var e in data.TargetLanguages)
    {
        <button class="btn btn-sm @CssBtnTarget(e.LangKey)" title="@e.EnglishName" @onclick="@(() => SetTargetLanguage(e.LangKey))">@e.ShortName</button>
    }
</div>

<div class="btn-group w-100 mt-2">
    <button class="btn btn-sm btn-secondary disabled twa-first-button">Support</button>
    @foreach (var e in data.SupportLanguages)
    {
        <button class="btn btn-sm @CssBtnSecondary(e.LangKey)" @onclick="@(() => SelectSecondary(e.LangKey))">@e.ShortName</button>
    }
</div>

@code {

    [Parameter]
    public EventCallback OnClick { get; set; }

    private async Task SelectSecondary(string helperLanguage)
    {
        if (helperLanguage != data.HelperLanguage)
        {
            data.HelperLanguage = helperLanguage;
            await OnClick.InvokeAsync();
        }
    }

    private async Task SetTargetLanguage(string targetLanguage)
    {
        if (targetLanguage != data.TargetLanguage)
        {
            data.TargetLanguage = targetLanguage;
            await OnClick.InvokeAsync();
        }
    }

    private async Task SetProjectId(int projectId)
    {
        if (projectId != data.ProjectId)
        {
            data.SetProjectId(projectId);
            await OnClick.InvokeAsync();
        }
    }

    private string CssBtnProject(int projectId)
    {
        if (projectId == data.ProjectId)
            return "btn-primary active";
        else
            return "btn-outline-primary";
    }

    private string CssBtnTarget(string btnLang)
    {
        if (btnLang == data.TargetLanguage)
            return "btn-primary active";
        else
            return "btn-outline-primary";
    }

    private string CssBtnSecondary(string btnLang)
    {
        if (btnLang == data.HelperLanguage)
            return "btn-primary active";
        else
            return "btn-outline-primary";
    }

}
